<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HackoAI ‚Ä¢ Neural Interface</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Smooch+Sans:wght@300..800&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
<script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/highlight.min.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#020617;--panel:#0f172a;--chat:#1e293b;
  --border:#1f2937;--user:#2563eb;--bot:#020617;
  --text:#e5e7eb;--muted:#94a3b8;
}
body{
  font-family:system-ui;
  background:var(--bg);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  color:var(--text);
}
.app{
  width:100%;max-width:700px;height:92vh;
  background:var(--panel);
  border-radius:16px;
  display:flex;flex-direction:column;
  box-shadow:0 30px 60px rgba(0,0,0,.6);
  overflow:hidden;
}
header{
  padding:14px 16px;
  border-bottom:1px solid var(--border);
  display:flex;justify-content:space-between;align-items:center;
  font-weight:600;
}
.controls{display:flex;gap:8px}
select,button{
  background:transparent;border:1px solid var(--border);
  color:var(--text);padding:6px 10px;
  border-radius:8px;cursor:pointer;
}
#chat{
  flex:1;padding:16px;overflow-y:auto;
  display:flex;flex-direction:column;gap:14px;
  background:var(--chat);
}
.msg{
  max-width:85%;
  padding:12px 14px;
  border-radius:12px;
  line-height:1.5;
  animation:fade .2s forwards;
  word-wrap:break-word;
}
.user{align-self:flex-end;background:var(--user);color:#fff}
.bot{align-self:flex-start;background:var(--bot)}
.timestamp{font-size:10px;color:var(--muted);margin-top:4px}
pre{
  background:#020617;padding:12px;border-radius:10px;
  margin-top:8px;position:relative;overflow-x:auto;
}
.copy-btn{
  position:absolute;top:6px;right:6px;
  font-size:11px;background:#2563eb;color:#fff;
  border:none;border-radius:6px;padding:4px 8px;
}
footer{
  display:flex;gap:8px;padding:12px;
  border-top:1px solid var(--border);
}
textarea{
  flex:1;resize:none;max-height:120px;
  padding:12px;border-radius:8px;
  border:1px solid var(--border);
  background:transparent;color:var(--text);
}
.send{
  background:#2563eb;border:none;color:#fff;
  padding:0 18px;border-radius:8px;font-weight:600;
}
.typing{
  font-size:12px;color:var(--muted);
  padding-left:6px;
}
@keyframes fade{from{opacity:0}to{opacity:1}}
.spinner{
  width:16px;height:16px;border:3px solid var(--border);
  border-top:3px solid #2563eb;border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>

<body>
<div class="app">
<header>
  HackoAI
  <div class="controls">
    <select id="model">
      <option value="auto">Auto</option>
      <option value="fast">Fast</option>
      <option value="reasoning">Reasoning</option>
    </select>
    <button onclick="clearChat()">üóëÔ∏è</button>
  </div>
</header>

<div id="chat"></div>

<footer>
  <textarea id="input" rows="1" placeholder="Drop a thought‚Ä¶"></textarea>
  <button class="send" onclick="send()">Send</button>
</footer>
</div>

<script>
const chat=document.getElementById("chat");
const input=document.getElementById("input");
const model=document.getElementById("model");
const KEY="hackoai_chat";

let history=JSON.parse(localStorage.getItem(KEY)||"[]");
history.forEach(m=>render(m.role,m.content,false));

function save(role,content){
  history.push({role,content});
  localStorage.setItem(KEY,JSON.stringify(history));
}

function time(){
  const d=new Date();
  return d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
}

function sanitize(t){
  return t.replace(/<script.*?>.*?<\/script>/gi,"");
}

function render(role,content,saveIt=true){
  const d=document.createElement("div");
  d.className="msg "+role;
  d.innerHTML=marked.parse(sanitize(content));
  d.querySelectorAll("pre code").forEach(b=>{
    hljs.highlightElement(b);
    const btn=document.createElement("button");
    btn.className="copy-btn";
    btn.textContent="COPY";
    btn.onclick=()=>{
      navigator.clipboard.writeText(b.textContent);
      btn.textContent="COPIED";
      setTimeout(()=>btn.textContent="COPY",1000);
    };
    b.parentElement.appendChild(btn);
  });
  const t=document.createElement("div");
  t.className="timestamp";t.textContent=time();
  d.appendChild(t);
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
  if(saveIt) save(role,content);
}

function clearChat(){
  if(!confirm("Nuke the convo? üíÄ"))return;
  history=[];localStorage.removeItem(KEY);
  chat.innerHTML="";
  render("bot","Fresh boot. Neural stack online ‚ö°");
}

input.addEventListener("input",()=>{
  input.style.height="auto";
  input.style.height=input.scrollHeight+"px";
});

async function send(){
  const text=input.value.trim();
  if(!text)return;
  input.value="";input.style.height="auto";
  render("user",text);

  const typing=document.createElement("div");
  typing.className="typing";
  typing.innerHTML="<div class='spinner'></div> AI thinking‚Ä¶";
  chat.appendChild(typing);

  try{
    const res=await fetch("/.netlify/functions/hackoAI",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({ text, model:model.value })
    });
    const data=await res.json();
    typing.remove();
    const answer=data?.choices?.[0]?.message?.content;
    if(!answer) throw 0;
    render("bot",answer);
  }catch{
    typing.remove();
    render("bot","Server folded üíÄ Retry?");
  }
}

input.addEventListener("keydown",e=>{
  if(e.key==="Enter"&&!e.shiftKey){
    e.preventDefault();send();
  }
});
</script>
</body>
</html>

